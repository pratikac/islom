(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     74325,       1831]
NotebookOptionsPosition[     73822,       1810]
NotebookOutlinePosition[     74290,       1829]
CellTagsIndexPosition[     74247,       1826]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  StyleBox["\[IndentingNewLine]",
   FontFamily->"Courier New",
   FontColor->GrayLevel[0]], 
  RowBox[{
   RowBox[{"<<", "PlotLegends`"}], 
   StyleBox["\[IndentingNewLine]",
    FontFamily->"Courier New",
    FontColor->GrayLevel[0]], 
   RowBox[{
    RowBox[{
     StyleBox["values",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]], 
     StyleBox["=",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]], 
     RowBox[{
      StyleBox["{",
       FontFamily->"Courier New",
       FontColor->GrayLevel[0]], 
      RowBox[{
       RowBox[{
        StyleBox["M",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        StyleBox[" ",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        StyleBox["\[Rule]",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], " ", "4.7"}], ",", " ", 
       StyleBox[
        RowBox[{"mw", " ", "\[Rule]", " ", "1.5"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"mp", " ", "\[Rule]", " ", "2.5"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"ml", " ", "\[Rule]", " ", "0.7"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"Jw", " ", "\[Rule]", " ", "0.02"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"Jb", " ", "\[Rule]", " ", "0.086"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"K", " ", "\[Rule]", " ", "500"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"l0", " ", "\[Rule]", " ", "0.2"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"h", " ", "\[Rule]", " ", "0.3"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"d", "\[Rule]", " ", "0.1"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"dw", " ", "\[Rule]", " ", "0.2"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"g", "\[Rule]", " ", "9.8"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[",",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[" ",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox["len",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        StyleBox[" ",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        StyleBox["\[Rule]",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], " ", "0.5"}], ",", " ", 
       RowBox[{"lmax", " ", "\[Rule]", " ", "0.4"}], ",", " ", 
       RowBox[{"hmax", " ", "\[Rule]", " ", "1"}], ",", " ", 
       RowBox[{"extendAccel", " ", "\[Rule]", " ", "15"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xl", "[", "t_", "]"}], "=", " ", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", " ", "-", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l", "[", "t", "]"}], "-", " ", "h"}], ")"}], " ", 
          RowBox[{"Tan", " ", "[", 
           RowBox[{"theta", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", " ", "[", 
        RowBox[{"theta", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yl", "[", "t_", "]"}], "=", " ", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"l", "[", "t", "]"}], " ", "-", " ", "h"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"theta", "[", "t", "]"}], "]"}]}], " ", "+", " ", 
      RowBox[{"d", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"theta", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xw", "[", "t_", "]"}], "=", " ", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], " ", "-", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dw", " ", "-", "d"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"theta", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yw", "[", "t_", "]"}], "=", " ", 
     RowBox[{
      RowBox[{"y", "[", "t", "]"}], " ", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"dw", " ", "-", "d"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"theta", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"xp", "[", "t_", "]"}], "=", " ", 
     RowBox[{
      RowBox[{"x", "[", "t", "]"}], " ", "+", " ", 
      RowBox[{"d", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"theta", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"yp", "[", "t_", "]"}], "=", " ", 
     RowBox[{
      RowBox[{"y", "[", "t", "]"}], " ", "+", " ", 
      RowBox[{"d", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"theta", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "mw", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"xw", "'"}], "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"yw", "'"}], "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", 
      "+", "  ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "mp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"xp", "'"}], "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"yp", "'"}], "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", 
      "+", "  ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "ml", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"xl", "'"}], "[", "t", "]"}], "^", "2"}], " ", "+", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"yl", "'"}], "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", 
      "+", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "Jw", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"phi", "'"}], "[", "t", "]"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"theta", "'"}], "[", "t", "]"}]}], ")"}], "^", "2"}]}], 
      " ", "+", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "Jb", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"theta", "'"}], "[", "t", "]"}], "^", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", " ", "=", " ", 
     RowBox[{
      RowBox[{"g", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ml", " ", 
          RowBox[{"yl", "[", "t", "]"}]}], " ", "+", " ", 
         RowBox[{"mw", " ", 
          RowBox[{"yw", "[", "t", "]"}]}], " ", "+", " ", 
         RowBox[{"mp", " ", 
          RowBox[{"yp", "[", "t", "]"}]}]}], ")"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", "K", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"l", "[", "t", "]"}], " ", "-", " ", "l0"}], ")"}], "^", 
        "2"}]}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqConstraintStance", " ", "=", " ", 
     RowBox[{"y", " ", "\[Rule]", "  ", 
      RowBox[{"Function", "[", 
       RowBox[{"t", ",", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"len", " ", "-", " ", 
           RowBox[{"l", "[", "t", "]"}], " ", "-", " ", 
           RowBox[{"d", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"theta", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"theta", "[", "t", "]"}], "]"}]}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", " ", 
     RowBox[{"T", " ", "-", "V"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", " ", 
     RowBox[{"L", " ", "/.", " ", "eqConstraintStance"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"x", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
        ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"x", "[", "t", "]"}]}], "]"}]}]}], ";"}], "  ", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"l", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
        ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"l", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"theta", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}],
         ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"theta", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq4", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"phi", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
        ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"phi", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqStance", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"eq1", ",", " ", "eq2", ",", " ", "eq3", ",", " ", "eq4"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"uL", "[", "t_", "]"}], " ", "=", "\[IndentingNewLine]", 
     RowBox[{"Piecewise", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{
            RowBox[{"l", "[", "t", "]"}], " ", "<", " ", "l0"}]}], "}"}], ",", 
         RowBox[{"{", " ", 
          RowBox[{"extendAccel", ",", " ", 
           RowBox[{"l0", " ", "\[LessEqual]", " ", 
            RowBox[{"l", "[", "t", "]"}], " ", "\[LessEqual]", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"lmax", " ", "+", " ", "l0"}], ")"}], "/", "2"}]}]}], 
          "}"}], ",", " ", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"-", "extendAccel"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"lmax", "+", "l0"}], ")"}], "/", "2"}], " ", 
            "\[LessEqual]", " ", 
            RowBox[{"l", "[", "t", "]"}], " ", "\[LessEqual]", " ", 
            "lmax"}]}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", 
           RowBox[{
            RowBox[{"l", "[", "t", "]"}], " ", ">", "  ", "lmax"}]}], "}"}]}],
         "}"}], " ", "/.", " ", "values"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", " ", 
     RowBox[{"T", " ", "-", " ", "V"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq1", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"x", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
        ",", " ", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"x", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq2", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"y", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
        ",", " ", "t"}], "]"}], "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq3", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"l", "[", "t", "]"}], ",", " ", "t"}], "]"}], ",", "t"}], 
       "]"}], " ", "\[Equal]", " ", 
      RowBox[{"uL", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq4", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"theta", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}],
         ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"theta", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eq5", " ", "=", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", " ", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"phi", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
        ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", " ", 
        RowBox[{"phi", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eqFlight", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
      "eq1", ",", " ", "eq2", ",", " ", "eq3", ",", " ", "eq4", ",", " ", 
       "eq5"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"eqFlight", " ", "=", " ", 
      RowBox[{"eqFlight", " ", "/.", " ", "values"}]}], ";"}],
    FontFamily->"Courier New",
    FontColor->GrayLevel[0]], "\[IndentingNewLine]", 
   StyleBox[
    RowBox[{
     RowBox[{"eqStance", " ", "=", " ", 
      RowBox[{"eqStance", " ", "/.", " ", "values"}]}], ";"}],
    FontFamily->"Courier New",
    FontColor->GrayLevel[0]], "\n"}]}]], "Input",
 CellChangeTimes->{{3.4753842219676*^9, 3.4753842260656*^9}, 
   3.4754092106085997`*^9, 3.4754137105916*^9, 3.4768329959484*^9, {
   3.4768332159964*^9, 3.4768332399764*^9}, 3.4768332781594*^9, {
   3.4770215612888002`*^9, 3.4770215680998*^9}, {3.4770216292268*^9, 
   3.4770216752728*^9}, {3.4770217474938*^9, 3.4770217537408*^9}, {
   3.4770223469358*^9, 3.4770223619788*^9}, 3.4770248974038*^9, 
   3.4770274008817997`*^9, {3.4770274340668*^9, 3.4770274827628*^9}, 
   3.4770282360278*^9, {3.4771120710327997`*^9, 3.4771121125478*^9}, {
   3.4771121496688004`*^9, 3.4771121874698*^9}, 3.4771144640348*^9, {
   3.4771153480987997`*^9, 3.4771153563838*^9}, {3.4771154616628*^9, 
   3.4771154850128*^9}, {3.4771155272248*^9, 3.4771155646057997`*^9}, {
   3.4771156218627996`*^9, 3.4771157189618*^9}, {3.4771157659568*^9, 
   3.4771158542478*^9}, {3.4771163003487997`*^9, 3.4771163006258*^9}, {
   3.4771163482228003`*^9, 3.4771163751528*^9}, {3.4771164197558002`*^9, 
   3.4771164739728003`*^9}, {3.4771165469508*^9, 3.4771166129007998`*^9}, {
   3.4771166459158*^9, 3.4771167119688*^9}, {3.4771171107538*^9, 
   3.4771171113468*^9}, {3.4771862456268*^9, 3.4771863759158*^9}, {
   3.4771864806308002`*^9, 3.4771865162338*^9}, 3.4771866654118*^9, {
   3.4771867945818*^9, 3.4771868397248*^9}, {3.4771882007668*^9, 
   3.4771882103348*^9}, {3.4771883082748003`*^9, 3.4771884036928*^9}, {
   3.4771886936668*^9, 3.4771886945788*^9}, {3.4771887550108*^9, 
   3.4771887902038*^9}, {3.4771888676328*^9, 3.4771888861998*^9}, 
   3.4771890249378*^9, {3.4771890627618*^9, 3.4771890998817997`*^9}, {
   3.4771891385538*^9, 3.4771891584418*^9}, {3.4771891958028*^9, 
   3.4771892418348*^9}, {3.4771892868268003`*^9, 3.4771892875788*^9}, {
   3.4771893320908003`*^9, 3.4771893323728*^9}, {3.4771893723988*^9, 
   3.4771894662628*^9}, {3.4771894996358*^9, 3.4771895274818*^9}, 
   3.4771897829658003`*^9, {3.4771898188648*^9, 3.4771898381608*^9}, {
   3.4771907620948*^9, 3.4771908677068*^9}, {3.4771909002628*^9, 
   3.4771909450788*^9}, {3.4771910312948*^9, 3.4771910937307997`*^9}, {
   3.4771911608148003`*^9, 3.4771912275078*^9}, {3.4771913497988*^9, 
   3.4771914112178*^9}, {3.4771915304468*^9, 3.4771915539848003`*^9}, {
   3.4771916454458*^9, 3.4771919569088*^9}, {3.4771920653958*^9, 
   3.4771921085278*^9}, {3.4771934577058*^9, 3.4771934779398003`*^9}, {
   3.4771935930327997`*^9, 3.4771936231038*^9}, {3.4771941292558002`*^9, 
   3.4771941462958*^9}, {3.4771966926858*^9, 3.4771966930998*^9}, {
   3.4772008944468*^9, 3.4772010148838*^9}, {3.4772010601018*^9, 
   3.4772010883898*^9}, {3.4772011765257998`*^9, 3.4772013193638*^9}, {
   3.47728996616615*^9, 3.47728997523915*^9}, {3.47729080392315*^9, 
   3.4772908122561502`*^9}, {3.4777896051054497`*^9, 
   3.4777896069029503`*^9}, {3.47778964945795*^9, 3.47778965559795*^9}, 
   3.47779214394195*^9, {3.47791098780945*^9, 3.47791099350345*^9}, {
   3.47791206835745*^9, 3.47791208344545*^9}, {3.4779183506834497`*^9, 
   3.47791836176145*^9}, 3.47791864793745*^9, {3.47791869517945*^9, 
   3.4779187009844503`*^9}, {3.47815829662845*^9, 3.47815831614645*^9}, {
   3.47816103850345*^9, 3.47816107737545*^9}, {3.47816111708145*^9, 
   3.47816115983145*^9}, {3.47816124932545*^9, 3.47816125159645*^9}, {
   3.47816157225845*^9, 3.4781615726834497`*^9}, {3.47816686673695*^9, 
   3.47816688160445*^9}, {3.4781902722164497`*^9, 3.4781903180464497`*^9}, {
   3.47819292242795*^9, 3.47819292360795*^9}, {3.47819296167045*^9, 
   3.4781929641304502`*^9}, {3.4781973001929502`*^9, 3.47819734347545*^9}, {
   3.47819750240795*^9, 3.47819755557295*^9}, {3.47819764841295*^9, 
   3.47819770661795*^9}, {3.47819774493045*^9, 3.47819785451295*^9}, {
   3.4781979799804497`*^9, 3.47819812965795*^9}, {3.47819825257045*^9, 
   3.47819828514795*^9}, {3.47819841049045*^9, 3.47819850742295*^9}, 
   3.47819872133545*^9, {3.4781989542129498`*^9, 3.4781989796279497`*^9}, {
   3.47822090393145*^9, 3.47822091791645*^9}, {3.47822122462145*^9, 
   3.4782212554289503`*^9}, {3.47822129739145*^9, 3.47822146314645*^9}, 
   3.47822157481645*^9, {3.47822190437895*^9, 3.47822193590145*^9}, {
   3.47822231653645*^9, 3.47822235491645*^9}, 3.47822245496395*^9, 
   3.4782224868039503`*^9, {3.47822263682895*^9, 3.47822266848145*^9}, {
   3.47822408984245*^9, 3.47822409557495*^9}, {3.47822414427745*^9, 
   3.47822418275495*^9}, {3.47822938537145*^9, 3.47822939662395*^9}, {
   3.47832004898565*^9, 3.4783200549306498`*^9}, {3.478354601493292*^9, 
   3.478354602823976*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"spring2Phase", "[", 
     RowBox[{"{", 
      RowBox[{
      "t0_", ",", " ", "x0_", ",", " ", "y0_", ",", " ", "len0_", ",", " ", 
       "theta0_", ",", " ", "phi0_", ",", " ", "xdot0_", ",", " ", "ydot0_", 
       ",", " ", "lendot0_", ",", " ", "thetadot0_", ",", " ", "phidot0_"}], 
      "}"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "pSpring2", "}"}], ",", "\[IndentingNewLine]", 
      StyleBox[
       RowBox[{
        RowBox[{
         RowBox[{"start", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"initSpring2", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", "0", "]"}], " ", "\[Equal]", " ", "x0"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"y", "[", "0", "]"}], " ", "\[Equal]", " ", "y0"}], ",", 
            " ", 
            RowBox[{
             RowBox[{"theta", "[", "0", "]"}], " ", "\[Equal]", " ", 
             "theta0"}], ",", " ", 
            RowBox[{
             RowBox[{"phi", "[", "0", "]"}], " ", "\[Equal]", " ", "phi0"}], 
            ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", " ", "xdot0"}],
             ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", " ", "ydot0"}],
             ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"theta", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
             "thetadot0"}], ",", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"phi", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
             "phidot0"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"solveForSpring2", " ", "=", 
          RowBox[{"{", 
           RowBox[{"x", ",", " ", "y", ",", " ", "theta", ",", " ", "phi"}], 
           "}"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eqConstraintSpring2", " ", "=", " ", 
          RowBox[{"l", " ", "\[Rule]", " ", 
           RowBox[{"Function", "[", 
            RowBox[{"t", ",", " ", "len0"}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", " ", "=", " ", 
          RowBox[{"T", " ", "-", "V"}]}], ";"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", " ", "=", " ", 
          RowBox[{"L", " ", "/.", " ", "eqConstraintSpring2"}]}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq1", " ", "=", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"L", ",", " ", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"x", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], 
              "]"}], ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"x", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq2", " ", "=", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"L", ",", " ", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"y", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], 
              "]"}], ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq3", " ", "=", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"L", ",", " ", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"theta", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], 
              "]"}], ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"theta", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eq4", " ", "=", " ", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"L", ",", " ", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"phi", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], 
              "]"}], ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"phi", "[", "t", "]"}]}], "]"}]}]}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eqSpring2", " ", "=", " ", 
          RowBox[{"{", 
           RowBox[{"eq1", ",", " ", "eq2", ",", " ", "eq3", ",", " ", "eq4"}],
            "}"}]}], ";"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"eqSpring2", " ", "=", " ", 
          RowBox[{"eqSpring2", " ", "/.", " ", "values"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"solSpring2", " ", "=", 
          RowBox[{"First", "[", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{"eqSpring2", ",", " ", "initSpring2"}], "]"}], ",", " ",
              "solveForSpring2", ",", " ", 
             RowBox[{"{", 
              RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
             RowBox[{"Method", " ", "\[Rule]", " ", 
              RowBox[{"{", 
               RowBox[{"\"\<EventLocator\>\"", ",", " ", 
                RowBox[{"\"\<Event\>\"", " ", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"y", "[", "t", "]"}], " ", "-", " ", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"len", " ", "-", " ", "len0", " ", "-", " ", 
                    RowBox[{"d", " ", 
                    RowBox[{"Sin", "[", 
                    RowBox[{"theta", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
                    RowBox[{"Cos", "[", 
                    RowBox[{"theta", "[", "t", "]"}], "]"}]}]}], ")"}], " ", "/.",
                    " ", "values"}], ")"}]}], ",", " ", 
                RowBox[{"\"\<EventAction\>\"", " ", ":>", " ", 
                 RowBox[{"Throw", "[", 
                  RowBox[{
                   RowBox[{"end", " ", "=", " ", "t"}], ",", " ", 
                   "\"\<StopIntegration\>\""}], "]"}]}]}], "}"}]}]}], "]"}], 
           "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pSpring2", " ", "=", 
          RowBox[{"ParametricPlot", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", "t", "]"}], " ", "/.", " ", "solSpring2"}], 
               ",", " ", 
               RowBox[{
                RowBox[{"y", "[", "t", "]"}], " ", "/.", " ", 
                "solSpring2"}]}], "}"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "end"}], "}"}], ",", " ", 
            RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"x", ",", " ", "y"}], "}"}]}], ",", " ", 
            RowBox[{"LabelStyle", " ", "\[Rule]", " ", 
             RowBox[{"Directive", "[", 
              RowBox[{"Black", ",", " ", "Bold"}], "]"}]}], ",", " ", 
            RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"Blue", ",", " ", 
               RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], ",", 
            RowBox[{"GridLines", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
            RowBox[{"GridLinesStyle", " ", "\[Rule]", " ", 
             RowBox[{"Directive", "[", "Dashed", "]"}]}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"end", "+", "t0"}], ",", " ", 
             RowBox[{"x", "[", "end", "]"}], ",", " ", 
             RowBox[{"y", "[", "end", "]"}], ",", " ", "len0", ",", " ", 
             RowBox[{"theta", "[", "end", "]"}], ",", " ", 
             RowBox[{"phi", "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"x", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"y", "'"}], "[", "end", "]"}], ",", "0", ",", " ", 
             RowBox[{
              RowBox[{"theta", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"phi", "'"}], "[", "end", "]"}]}], "}"}], " ", "/.", 
           " ", "solSpring2"}], ",", " ", "pSpring2"}], "}"}]}],
       FontFamily->"Courier New",
       FontColor->GrayLevel[0]]}], 
     StyleBox["\[IndentingNewLine]",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]], 
     StyleBox["]",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]]}]}], 
   StyleBox[";",
    FontFamily->"Courier New",
    FontColor->GrayLevel[0]]}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"spring1Phase", "[", 
     RowBox[{"{", 
      RowBox[{
      "t0_", ",", " ", "x0_", ",", " ", "y0_", ",", " ", "len0_", ",", " ", 
       "theta0_", ",", " ", "phi0_", ",", " ", "xdot0_", ",", " ", "ydot0_", 
       ",", " ", "lendot0_", ",", " ", "thetadot0_", ",", " ", "phidot0_"}], 
      "}"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "pSpring1", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       StyleBox[
        RowBox[{"start", " ", "=", " ", "0"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"initSpring1", "=", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "0", "]"}], " ", "\[Equal]", " ", "x0"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"y", "[", "0", "]"}], " ", "\[Equal]", " ", "y0"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"theta", "[", "0", "]"}], " ", "\[Equal]", " ", 
            "theta0"}], ",", " ", 
           RowBox[{
            RowBox[{"phi", "[", "0", "]"}], " ", "\[Equal]", " ", "phi0"}], 
           ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", " ", "xdot0"}], 
           ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", " ", "ydot0"}], 
           ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"theta", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
            "thetadot0"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phi", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
            "phidot0"}]}], "}"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"solveForSpring1", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "y", ",", " ", "theta", ",", " ", "phi"}], 
          "}"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       RowBox[{"eqConstraintSpring1", " ", "=", " ", 
        RowBox[{"l", " ", "\[Rule]", " ", 
         RowBox[{"Function", "[", 
          RowBox[{"t", ",", " ", "len0"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"L", " ", "=", " ", 
        RowBox[{"T", " ", "-", "V"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"L", " ", "=", " ", 
        RowBox[{"L", " ", "/.", " ", "eqConstraintSpring1"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq1", " ", "=", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"x", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
           ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
         RowBox[{"D", "[", 
          RowBox[{"L", ",", " ", 
           RowBox[{"x", "[", "t", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq2", " ", "=", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"y", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], "]"}], 
           ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
         RowBox[{"D", "[", 
          RowBox[{"L", ",", " ", 
           RowBox[{"y", "[", "t", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq3", " ", "=", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"theta", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], 
            "]"}], ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
         RowBox[{"D", "[", 
          RowBox[{"L", ",", " ", 
           RowBox[{"theta", "[", "t", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eq4", " ", "=", " ", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"L", ",", " ", 
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"phi", "[", "t", "]"}], ",", " ", "t"}], "]"}]}], 
            "]"}], ",", " ", "t"}], "]"}], " ", "\[Equal]", " ", 
         RowBox[{"D", "[", 
          RowBox[{"L", ",", " ", 
           RowBox[{"phi", "[", "t", "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqSpring1", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"eq1", ",", " ", "eq2", ",", " ", "eq3", ",", " ", "eq4"}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eqSpring1", " ", "=", " ", 
        RowBox[{"eqSpring1", " ", "/.", " ", "values"}]}], ";", 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"solSpring1", " ", "=", " ", 
         RowBox[{"First", "[", 
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"eqSpring1", ",", " ", "initSpring1"}], "]"}], ",", " ", 
            "solveForSpring1", ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "2"}], "}"}], ",", " ", 
            RowBox[{"Method", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<EventLocator\>\"", ",", " ", 
               RowBox[{
                RowBox[{"\"\<Event\>\"", " ", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"y", "[", "t", "]"}], " ", "-", "  ", "0.66"}], 
                  ")"}]}], " ", "/.", " ", "values"}], ",", " ", 
               RowBox[{"\"\<EventAction\>\"", " ", ":>", " ", 
                RowBox[{"Throw", "[", 
                 RowBox[{
                  RowBox[{"end", " ", "=", " ", "t"}], ",", " ", 
                  "\"\<StopIntegration\>\""}], "]"}]}]}], "}"}]}]}], "]"}], 
          "]"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"pSpring1", " ", "=", " ", 
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "t", "]"}], " ", "/.", " ", "solSpring1"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"y", "[", "t", "]"}], " ", "/.", " ", "solSpring1"}]}],
              "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", "end"}], "}"}], ",", " ", 
           RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", " ", "y"}], "}"}]}], ",", " ", 
           RowBox[{"LabelStyle", " ", "\[Rule]", " ", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", " ", "Bold"}], "]"}]}], ",", " ", 
           RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", " ", 
              RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], ",", 
           RowBox[{"GridLines", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
           RowBox[{"GridLinesStyle", " ", "\[Rule]", " ", 
            RowBox[{"Directive", "[", "Dashed", "]"}]}]}], "]"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox["{",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"end", "+", "t0"}], ",", " ", 
             RowBox[{"x", "[", "end", "]"}], ",", " ", 
             RowBox[{"y", "[", "end", "]"}], ",", " ", "len0", ",", " ", 
             RowBox[{"theta", "[", "end", "]"}], ",", " ", 
             RowBox[{"phi", "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"x", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"y", "'"}], "[", "end", "]"}], ",", " ", "0", ",", " ", 
             RowBox[{
              RowBox[{"theta", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"phi", "'"}], "[", "end", "]"}]}], "}"}], " ", "/.", 
           " ", "values"}], " ", "/.", " ", "solSpring1"}], ",", " ", 
         "pSpring1"}], "}"}]}]}], 
     StyleBox["\[IndentingNewLine]",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]], 
     StyleBox["]",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]]}]}], 
   StyleBox[";",
    FontFamily->"Courier New",
    FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"flightPhase", "[", 
     RowBox[{"{", 
      RowBox[{
      "t0_", ",", " ", "x0_", ",", " ", "y0_", ",", " ", "len0_", ",", " ", 
       "theta0_", ",", " ", "phi0_", ",", " ", "xdot0_", ",", " ", "ydot0_", 
       ",", " ", "lendot0_", ",", " ", "thetadot0_", ",", " ", "phidot0_"}], 
      "}"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "pFlight", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"start", " ", "=", " ", "0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"initFlight", " ", "=", " ", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"x", "[", "0", "]"}], " ", "\[Equal]", " ", "x0"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"y", "[", "0", "]"}], " ", "\[Equal]", " ", "y0"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"l", "[", "0", "]"}], " ", "\[Equal]", " ", "len0"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"theta", "[", "0", "]"}], " ", "\[Equal]", " ", "theta0"}],
           ",", " ", 
          RowBox[{
           RowBox[{"phi", "[", "0", "]"}], " ", "\[Equal]", " ", "phi0"}], 
          ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", " ", "xdot0"}], 
          ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"y", "'"}], "[", "0", "]"}], "\[Equal]", " ", "ydot0"}], 
          ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"l", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           "lendot0"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"theta", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           "thetadot0"}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"phi", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
           "phidot0"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"solveForFlight", " ", "=", 
        RowBox[{"{", 
         RowBox[{
         "x", ",", " ", "y", ",", " ", "l", ",", " ", "theta", ",", " ", 
          "phi"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"solFlight", " ", "=", " ", 
        RowBox[{"First", "[", 
         RowBox[{"NDSolve", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"eqFlight", ",", " ", "initFlight"}], "]"}], ",", " ", 
           "solveForFlight", ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", "5"}], "}"}], ",", 
           RowBox[{"MaxSteps", " ", "\[Rule]", " ", 
            RowBox[{"10", "^", "8"}]}], ",", " ", 
           RowBox[{"Method", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"\"\<EventLocator\>\"", ",", " ", 
              RowBox[{
               RowBox[{"\"\<Event\>\"", " ", "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"l", "[", "t", "]"}], " ", "-", " ", "lmax"}], 
                 ")"}]}], " ", "/.", " ", "values"}], " ", ",", "  ", 
              RowBox[{"\"\<Direction\>\"", " ", "\[Rule]", " ", 
               RowBox[{"-", "1"}]}], ",", 
              RowBox[{"\"\<EventAction\>\"", " ", ":>", " ", 
               RowBox[{"Throw", "[", 
                RowBox[{
                 RowBox[{"end", " ", "=", " ", "t"}], ",", " ", 
                 "\"\<StopIntegration\>\""}], "]"}]}]}], "}"}]}]}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       StyleBox[
        RowBox[{"pFlight", " ", "=", " ", 
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "t", "]"}], " ", "/.", " ", "solFlight"}], 
              ",", " ", 
              RowBox[{
               RowBox[{"y", "[", "t", "]"}], " ", "/.", " ", "solFlight"}]}], 
             " ", "}"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", "end"}], "}"}], ",", " ", 
           RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", " ", "y"}], "}"}]}], ",", " ", 
           RowBox[{"LabelStyle", " ", "\[Rule]", " ", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", " ", "Bold"}], "]"}]}], ",", " ", 
           RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"Green", ",", " ", 
              RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], ",", 
           RowBox[{"GridLines", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
           RowBox[{"GridLinesStyle", " ", "\[Rule]", " ", 
            RowBox[{"Directive", "[", "Dashed", "]"}]}]}], "]"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"end", "+", "t0"}], ",", " ", 
             RowBox[{"x", "[", "end", "]"}], ",", " ", 
             RowBox[{"y", "[", "end", "]"}], ",", " ", 
             RowBox[{"l", "[", "end", "]"}], ",", " ", 
             RowBox[{"theta", "[", "end", "]"}], ",", " ", 
             RowBox[{"phi", "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"x", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"y", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"l", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"theta", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"phi", "'"}], "[", "end", "]"}]}], "}"}], " ", "/.", 
           " ", "values"}], " ", "/.", " ", "solFlight"}], ",", " ", 
         "pFlight"}], "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"momentArm", "[", 
    RowBox[{"len0_", ",", " ", "theta0_"}], "]"}], " ", ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "arm", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"arm", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", 
           RowBox[{"Cos", "[", "theta0", "]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"len", " ", "-", " ", "len0", " ", "-", " ", 
             RowBox[{"d", " ", 
              RowBox[{"Sin", "[", "theta0", "]"}]}]}], ")"}], " ", 
           RowBox[{"Sin", "[", "theta0", "]"}]}]}], " ", ")"}], "/.", " ", 
        "values"}]}], ";", "\[IndentingNewLine]", "arm"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"stancePhase", "[", 
     RowBox[{"{", 
      RowBox[{
      "t0_", ",", " ", "x0_", ",", " ", "y0_", ",", " ", "len0_", ",", " ", 
       "theta0_", ",", " ", "phi0_", ",", " ", "xdot0_", ",", " ", "ydot0_", 
       ",", " ", "lendot0_", ",", " ", "thetadot0_", ",", " ", "phidot0_"}], 
      "}"}], "]"}], " ", ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "xdotnew", ",", " ", "ydotnew", ",", " ", "thetadotnew", ",", " ", 
        "arm", ",", " ", "vnew", ",", " ", "pStance"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       StyleBox[
        RowBox[{"start", " ", "=", " ", "0"}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"arm", " ", "=", " ", 
         RowBox[{"momentArm", "[", 
          RowBox[{"len0", ",", " ", "theta0"}], "]"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"thetadotnew", " ", "=", " ", 
         RowBox[{"thetadot0", " ", "+", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"M", "*", "ydot0", "*", 
              RowBox[{"arm", "/", "Jb"}]}], " ", ")"}], "/.", "values"}], 
           ")"}]}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"initStance", "=", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", "0", "]"}], " ", "\[Equal]", " ", "x0"}], ",", 
           " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l", "[", "0", "]"}], " ", "\[Equal]", " ", "len0"}], 
             ")"}], " ", "/.", " ", "values"}], ",", " ", 
           RowBox[{
            RowBox[{"theta", "[", "0", "]"}], " ", "\[Equal]", " ", 
            "theta0"}], ",", " ", 
           RowBox[{
            RowBox[{"phi", "[", "0", "]"}], " ", "\[Equal]", " ", "phi0"}], 
           ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "'"}], "[", "0", "]"}], "\[Equal]", " ", "0"}], ",",
            " ", 
           RowBox[{
            RowBox[{
             RowBox[{"l", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", "0"}],
            ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"theta", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
            "thetadotnew"}], ",", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"phi", "'"}], "[", "0", "]"}], " ", "\[Equal]", " ", 
            "phidot0"}]}], "}"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"solveForStance", " ", "=", " ", 
         RowBox[{"{", 
          RowBox[{"x", ",", " ", "l", ",", " ", "theta", ",", " ", "phi"}], 
          "}"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"solStance", " ", "=", " ", 
         RowBox[{"First", "[", 
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"eqStance", ",", " ", "initStance"}], "]"}], ",", " ", 
            "solveForStance", ",", " ", 
            RowBox[{"{", 
             RowBox[{"t", ",", " ", "0", ",", " ", "1"}], "}"}], ",", " ", 
            RowBox[{"Method", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"\"\<EventLocator\>\"", ",", " ", 
               RowBox[{
                RowBox[{"\"\<Event\>\"", " ", "\[Rule]", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"l", "[", "t", "]"}], " ", "-", " ", "l0"}], 
                  ")"}]}], " ", "/.", " ", "values"}], ",", " ", 
               RowBox[{"\"\<EventAction\>\"", " ", ":>", " ", 
                RowBox[{"Throw", "[", 
                 RowBox[{
                  RowBox[{"end", " ", "=", " ", "t"}], ",", " ", 
                  "\"\<StopIntegration\>\""}], "]"}]}]}], "}"}]}]}], "]"}], 
          "]"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox[
         RowBox[{"yFuncTemp", "[", "t_", "]"}],
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        StyleBox[" ",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        StyleBox[":=",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        StyleBox[" ",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        RowBox[{
         RowBox[{
          StyleBox["(",
           FontFamily->"Courier New",
           FontColor->GrayLevel[0]], 
          RowBox[{
           RowBox[{
            RowBox[{
             StyleBox["(",
              FontFamily->"Courier New",
              FontColor->GrayLevel[0]], 
             RowBox[{"len", " ", "-", " ", 
              RowBox[{"l", "[", "t", "]"}], " ", "-", " ", 
              RowBox[{"d", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"theta", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"theta", "[", "t", "]"}], "]"}]}], " ", "/.", " ", 
           "values"}], ")"}], " ", "/.", " ", "solStance"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ydotFuncTemp", "[", "t_", "]"}], " ", ":=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "len"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"theta", "[", "t", "]"}], "]"}]}], " ", "+", " ", 
             RowBox[{
              RowBox[{"l", "[", "t", "]"}], " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"theta", "[", "t", "]"}], "]"}]}], " ", "-", " ", 
             RowBox[{"d", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Cos", "[", 
                  RowBox[{"theta", "[", "t", "]"}], "]"}], "^", "2"}], " ", 
                "-", " ", 
                RowBox[{
                 RowBox[{"Sin", "[", 
                  RowBox[{"theta", "[", "t", "]"}], "]"}], "^", "2"}]}], 
               ")"}], "  ", 
              RowBox[{
               RowBox[{"theta", "'"}], "[", "t", "]"}]}], " ", "-", " ", 
             RowBox[{
              RowBox[{
               RowBox[{"l", "'"}], "[", "t", "]"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"theta", "[", "t", "]"}], "]"}]}]}], " ", ")"}], ")"}],
           " ", "/.", " ", "values"}], " ", "/.", " ", "solStance"}]}], ";", 
       "\[IndentingNewLine]", 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"pStance", " ", "=", " ", 
         RowBox[{"ParametricPlot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", "t", "]"}], " ", "/.", " ", "solStance"}], 
              ",", " ", 
              RowBox[{"yFuncTemp", "[", "t", "]"}]}], " ", "}"}], "]"}], ",", 
           " ", 
           RowBox[{"{", 
            RowBox[{"t", ",", " ", "0", ",", " ", "end"}], "}"}], ",", " ", 
           RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"x", ",", " ", "y"}], "}"}]}], ",", " ", 
           RowBox[{"LabelStyle", " ", "\[Rule]", " ", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", " ", "Bold"}], "]"}]}], ",", " ", 
           RowBox[{"PlotStyle", " ", "\[Rule]", " ", 
            RowBox[{"{", 
             RowBox[{"Red", ",", " ", 
              RowBox[{"Thickness", "[", "0.003", "]"}]}], "}"}]}], ",", 
           RowBox[{"GridLines", " ", "\[Rule]", " ", "Automatic"}], ",", " ", 
           RowBox[{"GridLinesStyle", " ", "\[Rule]", " ", 
            RowBox[{"Directive", "[", "Dashed", "]"}]}]}], "]"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"vnew", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"mw", " ", "+", " ", "mp"}], ")"}], "*", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{
                RowBox[{"l", "'"}], "[", "end", "]"}], "]"}], "/", "M"}]}], 
            " ", ")"}], " ", "/.", " ", "values"}], " ", "/.", "solStance"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"xdotnew", " ", "=", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"x", "'"}], "[", "end", "]"}], " ", "-", " ", 
           RowBox[{"vnew", " ", "*", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"theta", "[", "end", "]"}], "]"}]}]}], " ", "/.", " ", 
          "solStance"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[
        RowBox[{"ydotnew", " ", "=", " ", 
         RowBox[{
          RowBox[{"vnew", "*", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"theta", "[", "end", "]"}], "]"}]}], " ", "/.", " ", 
          "solStance"}]}],
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox[";",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       StyleBox["\[IndentingNewLine]",
        FontFamily->"Courier New",
        FontColor->GrayLevel[0]], 
       RowBox[{
        StyleBox["{",
         FontFamily->"Courier New",
         FontColor->GrayLevel[0]], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"end", "+", "t0"}], ",", " ", 
             RowBox[{"x", "[", "end", "]"}], ",", " ", 
             RowBox[{"yFuncTemp", "[", "end", "]"}], ",", " ", 
             RowBox[{"l", "[", "end", "]"}], ",", " ", 
             RowBox[{"theta", "[", "end", "]"}], ",", " ", 
             RowBox[{"phi", "[", "end", "]"}], ",", " ", "xdotnew", ",", " ", 
             "ydotnew", ",", " ", 
             RowBox[{
              RowBox[{"l", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"theta", "'"}], "[", "end", "]"}], ",", " ", 
             RowBox[{
              RowBox[{"phi", "'"}], "[", "end", "]"}]}], "}"}], " ", "/.", 
           " ", "values"}], " ", "/.", " ", "solStance"}], ",", " ", 
         "pStance"}], "}"}]}]}], 
     StyleBox["\[IndentingNewLine]",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]], 
     StyleBox["]",
      FontFamily->"Courier New",
      FontColor->GrayLevel[0]]}]}], 
   StyleBox[";",
    FontFamily->"Courier New",
    FontColor->GrayLevel[0]]}], "\[IndentingNewLine]", 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"init", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", " ", "0", ",", " ", "1", ",", " ", "l0", ",", " ", "0", ",", 
       " ", "0", ",", " ", "1", ",", "0", ",", " ", "0", ",", " ", "0", ",", 
       " ", "0"}], "}"}], " ", "/.", " ", "values"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"op1", ",", " ", "p1Flight"}], "}"}], " ", "=", " ", 
   RowBox[{"flightPhase", "[", "init", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op2", ",", " ", "p1Spring2"}], "}"}], " ", "=", " ", 
     RowBox[{"spring2Phase", "[", "op1", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op3", ",", " ", "p1Stance"}], "}"}], " ", "=", " ", 
     RowBox[{"stancePhase", "[", "op2", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"op4", ",", " ", "p2Flight"}], "}"}], " ", "=", " ", 
     RowBox[{"flightPhase", "[", "op3", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
     "p1Flight", ",", " ", "p1Spring2", ",", " ", "p1Stance", ",", " ", 
      "p2Flight", ",", " ", 
      RowBox[{"PlotRange", " ", "\[Rule]", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "2"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4753842219676*^9, 3.4753842260656*^9}, 
   3.4754092106085997`*^9, 3.4754137105916*^9, 3.4768329959484*^9, {
   3.4768332159964*^9, 3.4768332399764*^9}, 3.4768332781594*^9, {
   3.4770215612888002`*^9, 3.4770215680998*^9}, {3.4770216292268*^9, 
   3.4770216752728*^9}, {3.4770217474938*^9, 3.4770217537408*^9}, {
   3.4770223469358*^9, 3.4770223619788*^9}, 3.4770248974038*^9, 
   3.4770274008817997`*^9, {3.4770274340668*^9, 3.4770274827628*^9}, 
   3.4770282360278*^9, {3.4771120710327997`*^9, 3.4771121125478*^9}, {
   3.4771121496688004`*^9, 3.4771121874698*^9}, 3.4771144640348*^9, {
   3.4771153480987997`*^9, 3.4771153563838*^9}, {3.4771154616628*^9, 
   3.4771154850128*^9}, {3.4771155272248*^9, 3.4771155646057997`*^9}, {
   3.4771156218627996`*^9, 3.4771157189618*^9}, {3.4771157659568*^9, 
   3.4771158542478*^9}, {3.4771163003487997`*^9, 3.4771163006258*^9}, {
   3.4771163482228003`*^9, 3.4771163751528*^9}, {3.4771164197558002`*^9, 
   3.4771164739728003`*^9}, {3.4771165469508*^9, 3.4771166129007998`*^9}, {
   3.4771166459158*^9, 3.4771167119688*^9}, {3.4771171107538*^9, 
   3.4771171113468*^9}, {3.4771862456268*^9, 3.4771863759158*^9}, {
   3.4771864806308002`*^9, 3.4771865162338*^9}, 3.4771866654118*^9, {
   3.4771867945818*^9, 3.4771868397248*^9}, {3.4771882007668*^9, 
   3.4771882103348*^9}, {3.4771883082748003`*^9, 3.4771884036928*^9}, {
   3.4771886936668*^9, 3.4771886945788*^9}, {3.4771887550108*^9, 
   3.4771887902038*^9}, {3.4771888676328*^9, 3.4771888861998*^9}, 
   3.4771890249378*^9, {3.4771890627618*^9, 3.4771890998817997`*^9}, {
   3.4771891385538*^9, 3.4771891584418*^9}, {3.4771891958028*^9, 
   3.4771892418348*^9}, {3.4771892868268003`*^9, 3.4771892875788*^9}, {
   3.4771893320908003`*^9, 3.4771893323728*^9}, 3.4771893723988*^9, {
   3.4771894684737997`*^9, 3.4771894690698*^9}, {3.4771895359058*^9, 
   3.4771895948938*^9}, 3.4771897292478*^9, {3.4771915877528*^9, 
   3.4771915882538*^9}, {3.4771919224788*^9, 3.4771919244758*^9}, 
   3.4771920791768*^9, {3.4771921136558*^9, 3.4771922100218*^9}, {
   3.4771931271068*^9, 3.4771932577098*^9}, {3.4771932964618*^9, 
   3.4771932975098*^9}, {3.4771935377648*^9, 3.4771935538227997`*^9}, {
   3.4771936642438*^9, 3.4771936852668*^9}, {3.4771937628378*^9, 
   3.4771937660678*^9}, {3.4771941648438*^9, 3.4771942428087997`*^9}, {
   3.4771942980178003`*^9, 3.4771943148928003`*^9}, {3.4771956431758003`*^9, 
   3.4771956539268*^9}, {3.4771957123338003`*^9, 3.4771957125638*^9}, {
   3.4771959063747997`*^9, 3.4771959079688*^9}, {3.4771959558778*^9, 
   3.4771961534298*^9}, 3.4771967114678*^9, {3.4771967676647997`*^9, 
   3.4771969749088*^9}, {3.4777926652044497`*^9, 3.47779272488195*^9}, {
   3.47779275606945*^9, 3.47779284008445*^9}, {3.47791067854845*^9, 
   3.47791079652645*^9}, {3.47791083764445*^9, 3.47791092829945*^9}, {
   3.4779110294144497`*^9, 3.4779110327634497`*^9}, {3.47791106403645*^9, 
   3.47791108812745*^9}, {3.47791112748345*^9, 3.47791113012745*^9}, {
   3.4779111862894497`*^9, 3.47791118712245*^9}, {3.4779112740914497`*^9, 
   3.4779113010324497`*^9}, {3.47791133197945*^9, 3.47791134781345*^9}, {
   3.47791165561345*^9, 3.4779116988404503`*^9}, {3.47791174760745*^9, 
   3.4779117478814497`*^9}, {3.4779119198144503`*^9, 
   3.4779119211904497`*^9}, {3.47791197512845*^9, 3.47791198869345*^9}, {
   3.47791209295545*^9, 3.4779121071314497`*^9}, {3.47791235341645*^9, 
   3.47791238081345*^9}, {3.47791243896745*^9, 3.47791254313345*^9}, {
   3.4779125844474497`*^9, 3.47791258593845*^9}, {3.47791555941545*^9, 
   3.4779155602814503`*^9}, 3.47791738948945*^9, {3.47810044147645*^9, 
   3.4781005445324497`*^9}, {3.47810060200445*^9, 3.47810082080345*^9}, 
   3.47810120000345*^9, {3.47810197567345*^9, 3.4781019955764503`*^9}, {
   3.47810208287045*^9, 3.47810212886045*^9}, {3.47810251193145*^9, 
   3.47810251582745*^9}, {3.47810255714345*^9, 3.47810256161545*^9}, {
   3.4781025970064497`*^9, 3.4781026686304502`*^9}, {3.4781027644664497`*^9, 
   3.47810277225945*^9}, {3.47810284369945*^9, 3.47810286517745*^9}, {
   3.47810323499345*^9, 3.4781032423994503`*^9}, {3.4781032971904497`*^9, 
   3.47810331256845*^9}, {3.47810334633745*^9, 3.47810344631345*^9}, {
   3.47815806470545*^9, 3.47815808461145*^9}, {3.47815817878345*^9, 
   3.47815818431645*^9}, {3.47815854823845*^9, 3.4781585601824503`*^9}, {
   3.47815860347045*^9, 3.4781586042494497`*^9}, {3.47815934668645*^9, 
   3.4781596838624496`*^9}, {3.47815973123945*^9, 3.47815983273545*^9}, {
   3.4781598752484503`*^9, 3.4781599432234497`*^9}, {3.47816000009645*^9, 
   3.4781600210984497`*^9}, {3.47816007233245*^9, 3.47816008161545*^9}, {
   3.47816014403745*^9, 3.47816018508945*^9}, {3.4781605092744503`*^9, 
   3.4781605481234503`*^9}, {3.4781610844514503`*^9, 
   3.4781611710064497`*^9}, {3.47816123227645*^9, 3.47816125592345*^9}, {
   3.47816142418545*^9, 3.47816156479145*^9}, {3.47816499558945*^9, 
   3.4781650857894497`*^9}, {3.47816579363445*^9, 3.4781657966644497`*^9}, {
   3.47816584844445*^9, 3.47816587901445*^9}, {3.47816638746695*^9, 
   3.4781664047269497`*^9}, {3.47816646377695*^9, 3.47816646453445*^9}, {
   3.47816668057445*^9, 3.4781668539544497`*^9}, {3.47816691241695*^9, 
   3.4781670045869503`*^9}, {3.47816890018895*^9, 3.47816890325445*^9}, {
   3.47816932715095*^9, 3.47816932765345*^9}, {3.47816937989645*^9, 
   3.47816942031645*^9}, {3.47817479616245*^9, 3.47817479759995*^9}, {
   3.47817537711345*^9, 3.47817538958095*^9}, {3.47817542204595*^9, 
   3.4781754228484497`*^9}, {3.47817759850145*^9, 3.47817768041495*^9}, {
   3.47817771468295*^9, 3.47817775111595*^9}, 3.47817804427845*^9, {
   3.4781788066799498`*^9, 3.47817883262045*^9}, 3.47818043681145*^9, {
   3.4781809264289503`*^9, 3.47818096310145*^9}, {3.47818099775895*^9, 
   3.4781809995914497`*^9}, {3.47819047346145*^9, 3.47819048812895*^9}, {
   3.4781906353264503`*^9, 3.47819069660145*^9}, {3.47819077999395*^9, 
   3.47819082664895*^9}, {3.47819090301645*^9, 3.47819093290145*^9}, 
   3.4781909780464497`*^9, {3.47819126146395*^9, 3.47819126199645*^9}, {
   3.47819157835645*^9, 3.47819171790145*^9}, {3.4781919084839497`*^9, 
   3.4781919177189503`*^9}, {3.47819235826645*^9, 3.47819236373895*^9}, {
   3.47819249966395*^9, 3.47819250233395*^9}, {3.47819255048645*^9, 
   3.47819256475145*^9}, {3.47819265332395*^9, 3.47819272186895*^9}, 
   3.47819310007795*^9, {3.47819357557045*^9, 3.4781935771679497`*^9}, {
   3.47819370115795*^9, 3.47819377077295*^9}, {3.47819380610045*^9, 
   3.47819385597795*^9}, {3.47819394638545*^9, 3.4781939854429502`*^9}, {
   3.4781941790254498`*^9, 3.47819418121795*^9}, {3.47819464238295*^9, 
   3.47819466705545*^9}, {3.47819470620045*^9, 3.47819472039045*^9}, {
   3.4781947774254503`*^9, 3.4781948399629498`*^9}, {3.47819523603795*^9, 
   3.47819529213295*^9}, {3.47819615143045*^9, 3.4781961544429502`*^9}, {
   3.47819643291045*^9, 3.47819644120045*^9}, {3.47819666562045*^9, 
   3.47819668962295*^9}, {3.47819672374295*^9, 3.4781968341279497`*^9}, {
   3.47819868076545*^9, 3.47819868437045*^9}, {3.47819881098295*^9, 
   3.47819881354545*^9}, {3.47822198981395*^9, 3.4782220347164497`*^9}, {
   3.47822249562395*^9, 3.4782225661564503`*^9}, {3.47822264301145*^9, 
   3.47822268853395*^9}, {3.4782227304689503`*^9, 3.47822273416645*^9}, {
   3.47822277478645*^9, 3.47822279315895*^9}, {3.47822345248895*^9, 
   3.47822346948145*^9}, {3.47822351135645*^9, 3.47822357345645*^9}, {
   3.47822361062145*^9, 3.4782237943074503`*^9}, {3.47822385020995*^9, 
   3.47822405081245*^9}, {3.47822408300495*^9, 3.4782240847849503`*^9}, {
   3.4782242514724503`*^9, 3.47822425233995*^9}, {3.4782247962824497`*^9, 
   3.47822480760245*^9}, {3.47822501008245*^9, 3.47822501437745*^9}, {
   3.4782250874074497`*^9, 3.47822510023495*^9}, {3.47822559662645*^9, 
   3.4782255998664503`*^9}, {3.47822565677645*^9, 3.47822565901645*^9}, {
   3.4782266302754498`*^9, 3.4782266395504503`*^9}, {3.4782269737934504`*^9, 
   3.47822702249395*^9}, {3.47822746898895*^9, 3.47822750137395*^9}, {
   3.47822756876645*^9, 3.47822757083645*^9}, {3.4782276200939503`*^9, 
   3.47822762921145*^9}, {3.4782279383589497`*^9, 3.47822794127395*^9}, {
   3.4782282357564497`*^9, 3.47822823589645*^9}, {3.47822860106145*^9, 
   3.47822866097145*^9}, {3.47822891252645*^9, 3.47822891302645*^9}, {
   3.4782294218589497`*^9, 3.47822949974895*^9}, {3.47822957222395*^9, 
   3.47822959849395*^9}, {3.47822970093895*^9, 3.47822972340895*^9}, {
   3.47831994582065*^9, 3.47831994780865*^9}, 3.47831998644265*^9, {
   3.478353904314926*^9, 3.478354068494456*^9}, {3.478354140888604*^9, 
   3.478354338368351*^9}, {3.478354372637208*^9, 3.478354483693381*^9}, {
   3.478354614822152*^9, 3.478354625954705*^9}, {3.478354680555773*^9, 
   3.478354696508707*^9}, {3.478354745017738*^9, 3.478354792895471*^9}, {
   3.478354833277189*^9, 3.478354834895787*^9}, {3.47835487207494*^9, 
   3.47835492672026*^9}, {3.478354963161615*^9, 3.478354995413289*^9}, {
   3.478355049218958*^9, 3.478355154188379*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ParametricPlot", "::", "\<\"plln\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Limiting value \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(end\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" in \\\\\\\"\\\", \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\!\\({t, 0, end}\\), \\\"MT\\\"]\\)\[NoBreak]\\!\
\\(\\*StyleBox[\\\"\\\\\\\" is not a machine-size real number.\\\\\\\"\\\", \
\\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/plln\\\", ButtonNote -> \
\\\"ParametricPlot::plln\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.478355034593776*^9, 3.478355066692858*^9, {3.478355096729343*^9, 
   3.478355148922987*^9}}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1134, 708},
WindowMargins->{{3, Automatic}, {40, Automatic}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
Magnification->1.0000001192092896`,
FrontEndVersion->"7.0 for Linux x86 (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 21603, 577, 979, "Input"],
Cell[CellGroupData[{
Cell[22173, 601, 50804, 1189, 2673, "Input"],
Cell[72980, 1792, 826, 15, 24, "Message"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
